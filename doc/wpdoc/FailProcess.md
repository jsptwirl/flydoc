---
title: FailProcess
date: 2020-05-22T17:14:11
---

# FailProcess 网络数据请求失败UI处理方案

## 网络数据请求的发起源

只要有onload事件的，都可以进行网络数据的发起和接收

1. 表单
2. 数组型控件
3. 选项型控件

## 数据请求状态种类

以下内容删除，取值以UIFlyCode文档为准

|种类|取值|说明|
|---|---|---|
|请求完成|0|~~(暂不实现)~~|
|请求中|1|~~(暂不实现)~~|
|出错|2|~~例如入参出错导致的执行失败等~~|
|超时|3|~~网络请求超时，如服务器资源不足~~|
|断网|4|~~当前设备没有网络等~~|

## 请求失败的信息传递

请求失败与请求成功一样，都是通过datarequest里面的setter的ctrlcode进行通知，如果ctrlcode配置了控件的code，则失败信息通知对应的控件；否则失败信息将会直接通知给表单。

控件会提供对应的刷新按钮，表单会提供一个弹窗来提示用户是否要再次请求数据。再次请求数据会触发对应的reload事件。

![](http://apaas.wxchina.com:8881/wp-content/uploads/%25E6%2595%25B0%25E6%258D%25AE%25E8%25AF%25B7%25E6%25B1%2582%25E5%25A4%25B1%25E8%25B4%25A5%25E6%25B5%2581%25E7%25A8%258B%25E5%259B%25BE.png)

## Flycode处理请求失败

`Page` , `ArrayCtrl` 和 `PickerCtrl` 对象新增方法 `setLoadStatus(statusType)` 。

## 数据请求失败状态去除

当控件在接收到新的数据时，即自动撤销之前的失败状态。

## 数据请求失败UI示例

有三种显示效果，根据不同的情况使用

* 覆盖型

  适合数组型控件

* 弹窗型

  适合表单

* 内嵌型

  适合带选项控件

  > 只有对应的选项控件配置了 `onreload` 事件才会支持这种显示方式。

  ​

![](http://apaas.wxchina.com:8881/wp-content/uploads/..)