---
title: Address
date: 2020-05-20T17:07:43
---

# Address

地址控件，用于显示或录入地址，包括经纬度，行政区划，以及详细地址（POI）等信息。同时支持导航。

默认只记录地址，可通过属性控制收集行政区划信息。行政区划将直接通过高德的接口获取，然后与

该控件可以通过地图搜索选点的方式进行快捷填充，其中的行政区划部分目前只能通过地图选点来获取（此时也会更新经纬度和poi）。

详细地址部分可以直接手动编辑。

由于详细地址可以手动编辑，因此经纬度就只是一个参考，不保证能和地址精确匹配。

与控件 `location` 的却别在于，后者用于获取当前的位置信息，而前者没有此限制。

## Protocol

```json
{
    "type": "address",
    "title": "门店地址",
    "markregion": "0",
    "addreditable": "1",
    "readonly": "0",
    "value": "",
    "displaymode":""
}
```

### markregion

标记行政区划

用于设置地址控件是否支持行政区划的采集和编辑，会影响控件的UI交互和最终的取值。

### addreditable

【手机端无效】

是否可编辑地址，默认可以编辑

### displaymode

显示模式

|value|名字|meaning|
|---|---|---|
|default|默认|默认模式，默认显示地址录入页面，点击可进入地图页面|
|map|地图|只显示地图页面|
|mappicker|地址选择|只显示地图，并且没有确认和取消按钮，点击地址后会改编值并触发值改变事件|

> map 和 mappicker模式为手机端为解决特殊场景临时加入，web端不支持，手机端也不建议配置使用

## Value

### 无行政区划

此时控件不采集行政区划信息

```Json
// 无行政区划信息
{
    "latitude": "123.12345",
    "longitude": "123.12345",
    "timestamp": "1547028474203", // web暂时不提供
    "address": "广东省广州市天河区体育西路101号维多利广场32楼",
    "poiname": "维多利广场"
}
```

交互说明：通过地图选点得到的数据中，直接将高德返回的address和poiname合并生成控件的address字段值，并填充到输入框，该输入框也可以直接编辑控件的address字段。控件的poiname字段将不会单独显示，只是用于取值。

### 有行政区划

此时控件会采集行政区划信息

> 如果赋值时不包含行政区划信息，则对应显示区域数据为空，此时自动将 address 字段的值复制到 detailaddr 字段用于显示和编辑。

```json
// 有行政区划信息
{
    "latitude": "123.12345",
    "longitude": "123.12345",
    "timestamp": "1547028474203", // web暂时不提供
    "address": "广东省广州市天河区体育西路101号维多利广场32楼",
    "poiname": "维多利广场",
    "regionid": "80187",
    "country": "中国",
    "province": "广东省",
    "city": "广州市",
    "district": "天河区",
    "detailaddr": "体育西路101号维多利广场32楼"
}
```

* detailaddr

  详细地址，由地图选点后的结果合成：街道 + 门牌 + POI，合成后填入详细地址编辑框，之后也可以由用户手动修改。

* address

  完整地址，由控件拼接而成：`province` + `city` + `district` + `detailaddr`

* regionid

  区域编码，非高德的编码，而是平台自己定义的区域编码，由高德返回的行政区域信息在本地的行政区划数据中进行检索匹配后得到的。

交互说明：

1. 地图选点后
   1. 将高德返回的latitude，longitude，poiname， province，city，district三个值分别存储在控件的对应值选项中
   2. 并将这三个值合并为字符串显示在行政区划的位置。
   3. ......

## Component

|name|value|meaning|取值|赋值|
|---|---|---|---|---|
|coordinate|见下方|坐标|✅||
|address|广州市天河区体育西路101号32楼|地址|✅|✅|
|poiname|VT101维多利广场|poi名称|✅||

// coordinate 的数据格式为： `latitude` + `|` + `longitude` ， 例如 ：`123.145453143 | 235.1254658441`

## Event Trigger

* onload
* onvaluechange

> 1、目前由于一些技术原因，单纯修改详细地址不会触发值改变事件，只有地图选点，确认选中才会触发值改变。  
> 2、web端：地址控件点击delete icon，清空选中值也不会触发值改变事件。