---
title: 样式控制
date: 2020-05-19T19:39:22
---

# 控件样式控制

控件可以根据不同的需求，呈现出不同的形态，控制输入类型

控件样式控制主要用于对不同的控件在不同的场景需求下，自动调整样式。

## 影响控件样式的因素

### 控件标题样式

用于设置输入型控件的标题与内容的分布位置。不支持动态设置。

|名称|英文名|说明|配置方式|
|---|---|---|---|
|水平弹性|horizontal\_flex|（手机端特有）灵活处理显示样式，适合屏幕较小，且标题长度变化较大的场景|布局控件属性|
|水平固宽|horizontal\_fix|适合标题长度可控，需要整体布局更整齐的场景，手机端和web端的显示样式有所不同|布局控件属性|
|垂直|vertical|适合题长度变化较大，且需要整体布局更整齐的场景，手机端和web端的显示样式有所不同|布局控件属性|
|简化|basic|适合需要密集输入的场景，如table，另外list，layout等也能设置为简化样式|布局控件属性+table+filter|
|自动|auto|默认值，即自动使用上级样式|布局控件属性|

> 简化模式并非所有录入型控件均支持，具体参看附录。
>
> 自动样式时，如果上级是数组型控件，将使用该数组型控件的默认样式，如table和list都是basic，不再继续向上级获取样式，如果要调整数组型控件内部的控件样式，可以通过修改row控件的样式，或者再内嵌layout。

```json
{
    // 表单级的设置将会影响整个表单中所有的输入控件，包括弹窗中的。
    // 如果某个控件自身设置了指定的标题样式（非auto），那么该控件及其子控件将不受表单级设置的影响
    "pageinfo": {
        "ctrllayout": "horizontal_fix",
        "ctrltitlewidth": "110" //只在 ctrllayout == horizontal_fix 时有效，web端的默认值为110，手机端为88。支持设置百分比
    }
}

{
    "type": "panel",
    "ctrllayout": "auto",
    "ctrltitlewidth": ""
}
```

### 使用场景

在不同的场景下，录入型控件和部分数组型控件（如table）的会使用不同场景样式进行显示。

控件的场景样式有：

|场景|usage值|pagestatus值|说明|
|---|---|---|---|
|录入|input|1，2|录入状态下，用于数据采集，默认值|
|只读|readonly|3|禁止录入的状态，控件样式依然是录入的样式（此处暂时兼容现有样式实现即可）|
|查看|view|4|用于信息查看，只显示信息，显示更紧凑清晰|
|打印|print|5|用于表单打印预览和打印的内容输出，将会使用高对比度的颜色，去掉图标等|
|自动|auto|无|控件默认都是自动场景，即继承上层场景，而整个表单的默认场景是录入 场景|

pagestatus 值为影响整个表单中未设置 usage 值的容器控件。只有容器控件（如layout，panel，table）才支持手动设置 usage 值，并且设置后，将不受 pagestatus 状态影响。

```json
{
   "type": "panel",
   "usage": "auto"
}
```

`usage` 属性不支持 flycode 动态设置（未来应该需要支持通过 flycode 设置 pagestatus 值来整体刷新表单）。

### 控件形态

|形态|说明|
|---|---|
|单行输入|例如文本框，单选下拉框等，控件高度固定，内容只显示一行的控件|
|多行输入|例如大文本框，支持多选的各类picker等，其内容高度可以根据内容自动调整|
|特定输入|例如照片，附件等，有着特殊形态的内容输入的控件，通常这类控件的高度也能随着内容改变|

### 控件状态

当控件处在 `录入场景` 下时，控件的以下属性会影响控件的显示的通用属性包括

|控件状态|说明|
|---|---|
|只读|会影响控件的显示，如灰色背景，图标变暗等。|
|必填|主要是会在控件标题处显示必填标记，如果是简化模式，控件不显示该标记。|
|错误|控件有错误提示信息时的状态，会根据具体的样式，生成合适的提示样式。|

### 其他控件样式属性

对于特定的控件，如button，text，image等，有其特有的样式控制属性，这些参看对应控件的协议说明。

## 控件样式总规则

### Web端

* 表单
  1. 摘要模式下，背景为白色；录入模式下，背景为浅灰，突出白色可编辑区域。
* 布局容器
  1. 对于 layout 这种纯布局元素，保持不变
  2. 对于 panel 这类带格式的布局元素，提供默认的

## 选择类控件样式说明

### 手机端

以下为非树形结构的通用数据选择（即 key-value 形式选择）

|选项数量\\选则数量|1|1 ~ 10|1 ~ 100|大于 100|
|---|---|---|---|---|
|1|勾选按钮，状态按钮|\--|\--|\--|
|2|勾选按钮，开关，选择框|选择框|\--|\--|
|2~10|选择框，下拉框，对象选择|选择框，下拉框，对象选择|\--|\--|
|10~20|下拉框，对象选择|下拉框，对象选择|下拉框，对象选择|\--|
|1~200|选择列表，对象选择|选择列表，对象选择|选择列表，对象选择|选择列表，对象选择|
|大于 200|对象选择|对象选择|对象选择|对象选择|
|选择显示原则|直接显示|直接显示或者省略显示|省略显示|简要显示|
|选择显示原则|||||

# 旧样式协议

以下为旧的样式设计，目前依然兼容

## 基本形态分类

目前主要分为以下五种形态

|key|usage|
|---|---|
|plain|指控件自身不用提供border，由其所在容器提供|
|card|和plain类似，不同之处在于通常控件显示的宽度更窄一点|
|free|控件需要提供border，用于标识控件的显示范围|
|grid/basic|网格模式，用在显示区域很小的地方，通常是表格|
|compact|紧凑模式，用于显示只读的信息，可以最大限度的利用空间显示信息|
|print|打印模式，用于显示打印信息，此时和紧凑模式基本一致，但所有字体颜色变为纯黑色|
|||

以文本输入框为例：

![](http://apaas.wxchina.com:8881/wp-content/uploads/BGView1.png)

### Compact

该模式下控件显示规则如下：

1. 标题型控件不显示边框，控件内容按正常文字颜色显示，控件标题显示为粗体。
2. panel和layout控件将不显示任何分割线，panel会继续保留边框，行高变为30pt
3. 表格将使用compact模式显示

## 协议约定

默认的，所有的控件都具有一个叫 `mode` 的属性，用于控制其显示模式

```json
{
    "type": "somekindctrl",
    "mode": "free"
}
```

不同的前端，mode的默认值不同

|前端类型|mode默认值|
|---|---|
|手机端|plain|
|web端|free|

## mode隐式继承

由于控件大多数时候的显示模式其实是由其所在的容器决定的，所以大多数时候不需要手动的去设置控件的显示模式，而是直接继承其父容器的mode属性值。

不同的容器控件有着不同的默认mode值：textinput

|ctrl|in mobile|in web|
|---|---|---|
|layout|plain|free|
|panel|plain|free|
|tabboard|plain|free|
|filter|free|free|
|list|basic|basic|
|sectionlist|basic|basic|
|table|grid|grid|
||||

容器控件本身通常不会受mode影响，其mode属性用于控制子控件样式

## 表单模式对mode的影响

|表单模式|影响|
|---|---|
|新增|无|
|编辑|无|
|查看|默认全部更改为 compact|
|打印|默认全部更改为 print|