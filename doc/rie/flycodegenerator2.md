---
title: FlyCodeGenerator ç‰ˆæœ¬æ—¥å¿— ğŸš€
layout: doc
---

# This repository has been archived by the owner on Jan 9, 2024. It is now read-only.

> https://github.com/Dwsy/FlyCodeGenerator/

# FlyCodeGenerator ç‰ˆæœ¬æ—¥å¿—

## FlyCodeGenerator 2.2 Released ğŸš€

### æ›´æ–°æ—¥å¿—

1. æ–°å¢ä¾§è¾¹ä»£ç ç¼–è¾‘åŠŸèƒ½,ä»£ç è¡Œæ•°å¤šçš„æ—¶å€™æ¯”è¾ƒå¥½ç”¨ã€‚
   ![Alt text](image-31.png)

2. æ–°å¢ä»£ç å¤§çº²åŠŸèƒ½,ä»£ç è¡Œæ•°å¤šçš„æ—¶å€™æ¯”è¾ƒå¥½ç”¨ã€‚

![Alt text](image-30.png)

> å› ä¸º IDE åœ¨å…³é—­é‚»åŸŸçš„æ—¶å€™æœªè§„èŒƒåˆ é™¤ monaco editor å¯¹è±¡æ‰€ä»¥æ¯ä¸ªé‚»åŸŸä»…ç¬¬ä¸€æ¬¡æ‰“å¼€çš„æ—¶å€™æ˜¾ç¤ºï¼Œå…³é—­åœ¨æ‰“å¼€æ— æ³•æ˜¾ç¤º

## FlyCodeGenerator 2.1 Released ğŸš€

### æ›´æ–°æ—¥å¿—

1.ä½¿ç”¨ pretty è¿›è¡Œä»£ç æ ¼å¼åŒ– 2.ä½¿ç”¨ babel å¯¹é«˜ç‰ˆæœ¬ es è¯­æ³•è¿›è¡Œé™çº§ æ”¯æŒ es2017
![Alt text](image-21.png)
![Alt text](image-22.png) 3.æ”¯æŒ SQL åˆ—æŸ¥è¯¢ä»£ç æç¤º
![Alt text](image-26.png)
from è¯­å¥å‰è‡ªåŠ¨è¡¥å…¨é€—å·ä¸æ³¨é‡Šåä¸å‡½æ•°è°ƒç”¨åªè¡¥å…¨å­—æ®µ
![Alt text](image-27.png) 4.æ·»åŠ äº†ä¸€å †ä»£ç ç‰‡æ®µ
å¦‚ for if fori foin foof
å¸¸ç”¨çš„å¦‚ ifend join å•¥çš„
![Alt text](image-28.png) 3.ç§»æ¤äº† vscode é»˜è®¤ä¸»é¢˜
![Alt text](image-23.png)
![Alt text](image-24.png) 4.æ·»åŠ äº† Monokai æš—é»‘æ¨¡å¼ä¸»é¢˜
![Alt text](image-25.png)

> 2.0 ç‰ˆæœ¬ä»£ç ç”Ÿæˆå™¨ä¸»è¦é’ˆå¯¹ç¨³å®šæ€§åšäº†ä¸€äº›ä¼˜åŒ–ï¼Œä»¥åŠå¢åŠ äº†ä¸€äº›å¿«é€Ÿç”Ÿæˆä»£ç çš„åŠŸèƒ½ã€‚

## FlyCodeGenerator 2.0 Released ğŸš€

Github Link
[FlyCodeGenerator 2.0](github.com/dwsy/flycodegenerator)

## ä»‹ç»

`FlyCodeGenerator` æ˜¯ä¸€æ¬¾åŸºäº[`vite-plugin-monkey`](https://github.com/lisonge/vite-plugin-monkey)å¼€å‘çš„ä¸€æ¬¾ä¸“ç”¨äºå¢å¼ºç„æ­¦ aPaaS Ide çš„æ’ä»¶ã€‚

---

## ä¸»è¦åŠŸèƒ½

1.æœ‰æ ¹æ®åè®®å¿«é€Ÿç”Ÿæˆ`å¢åˆ æ”¹æŸ¥`ä»£ç ã€‚

2.å¿«é€Ÿç”Ÿæˆ Excel å¯¼å…¥å¯¼å‡ºä»£ç å¯æ ¹æ®æ¨¡ç‰ˆè‡ªåŠ¨åæŸ¥`å®ä½“`ä»¥åŠè¿›è¡Œ`æ ¡éªŒ`æ“ä½œã€‚

3.å¢å¼º IDE ä»£ç è¡¥å…¨åŠŸèƒ½ï¼ŒåŒ…æ‹¬ APIï¼Œå®ä½“ï¼Œå‡ºå…¥å‚ç­‰ã€‚

4.å¿«é€Ÿç”Ÿæˆå®ä½“æŸ¥è¯¢ä»£ç ä¸ new BOï¼Œfor å¾ªç¯ç­‰ã€‚

5.æ”¯æŒå¯¹ flyquery SQL ä»£ç  è¿›è¡Œ`æ­£ç¡®çš„æ ¼å¼åŒ–`ã€‚

6.è‡ªå®šä¹‰ IDE ä¸»é¢˜ï¼Œå¢å¼ºç¼–è¾‘å™¨å¯¹ JS ä»£ç çš„`é«˜äº®`åŠŸèƒ½ã€‚

## æ³¨æ„

::: tip

> 1.0 ç‰ˆæœ¬ä½¿ç”¨æ²¹çŒ´åŠ è½½ï¼Œ2.0 å¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œbut å› ä¸º IDE5.1 ç‰ˆæœ¬å…³é—­äº† monaco çš„ global api æ‰€ä»¥é’ˆå¯¹ IDE åšäº†ä¸€äº›éœ€è¦ä½¿ç”¨æˆ‘çš„åå‘ä»£ç†ç½‘å€
> [ç‚¹å‡»è¿™é‡Œæ‰“å¼€](http://xwide.dwsy.link/#/login) å·²å†…ç½®æ’ä»¶æ— éœ€å®‰è£…æ²¹çŒ´ç‰ˆæœ¬

æ²¹çŒ´æ’ä»¶ç‰ˆæœ¬èœå•å¯ä»¥åœ¨æ²¹çŒ´ä¸­é…ç½®åŠŸèƒ½å¼€å…³
![Alt text](image-20.png)
å†…ç½®ç‰ˆæœ¬é¼ æ ‡æ»‘åˆ°å³ä¸‹è§’æ˜¾ç¤º
![Alt text](image-19.png)
:::

## åŠŸèƒ½æ¼”ç¤º

### 1.å¿«é€Ÿç”Ÿæˆå¢åˆ æ”¹æŸ¥ä»£ç 

#### 1. åˆ—è¡¨æŸ¥è¯¢

æ–°å¢é¢†åŸŸåé€‰æ‹©æ“ä½œç±»å‹ä¸º`åˆ—è¡¨æŸ¥è¯¢`é€‰æ‹©è¾“å…¥è¾“å‡ºå®ä½“åé‡æ–°æ‰“å¼€é¢†åŸŸï¼Œç‚¹å‡»`ç”Ÿæˆ`æŒ‰é’®å³å¯ã€‚
![Alt text](image-1.png)
ç”Ÿæˆçš„ä»£ç ä¼šæ ¹æ®å…¥å‚è¿›è¡Œç­›é€‰ä»¥åŠå‡ºå‚ä¸­å…³è”çš„å®ä½“è¿›è¡Œè¿è¡¨æŸ¥è¯¢ã€‚

::: details ç‚¹å‡»æŸ¥çœ‹ç”Ÿæˆçš„ä»£ç 

```js
SELECT
  tcd.id,  //ç»ˆç«¯ID
  tcd.code,  //ç»ˆç«¯ç¼–ç 
  tcd.marketing_region,  //ç»ˆç«¯æ‰€å±è¥é”€åŒºåŸŸ
  ps_mar.fullname as marketing_region__fullname,  //nameè·¯å¾„
  tcd.channel_type,  //æ¸ é“ç±»å‹
  tcd.level,  //ç»ˆç«¯çº§åˆ«
  tcd.contact_name,  //è”ç³»äººå§“å
  tcd.telephone_number,  //è”ç³»äººç”µè¯
  tcd.detailed_addresses,  //è¯¦ç»†åœ°å€
  tcd.administrative_region,  //è¡Œæ”¿åŒºåŸŸ
  pr_adm.regionname as administrative_region__regionname,  //è¡Œæ”¿åŒºåŸŸåç§°
  pr_adm.namepath as administrative_region__namepath,  //åŒºåŸŸåç§°è·¯å¾„
  tcd.manager,  //ç»ˆç«¯è´Ÿè´£äºº
  m_man.orgname as manager__orgname,  //æˆå‘˜å§“å
  tcd.head_photo,  //å¤´é—¨ç…§ç‰‡
  tcd.create_time,  //åˆ›å»ºæ—¶é—´
  tcd.update_time,  //ä¿®æ”¹æ—¶é—´
  tcd.name,  //ç»ˆç«¯åç§°
  tcd.type,  //ç»ˆç«¯ç±»å‹
  ks_typ.dicvalue as type__dicvalue,  //å­—å…¸å€¼
  tcd.created_user,  //åˆ›å»ºäºº
  tcd.approval_status  //å®¡æ‰¹çŠ¶æ€
FROM
  tn_crm_dwy as tcd
LEFT JOIN pl_orgstruct as ps_mar ON ps_mar.orgstructid = tcd.marketing_region
LEFT JOIN pl_region as pr_adm ON pr_adm.regionid = tcd.administrative_region
LEFT JOIN pl_orgstruct as m_man ON m_man.orgstructid = tcd.manager
LEFT JOIN pl_dictionary as ks_typ ON ks_typ.dickey = tcd.type
WHERE 1=1
// ç»ˆç«¯ç¼–ç 
{#if !String.isBlank(IN.tn_crm_dwy.code)}
  and tcd.code LIKE { '%' + {IN.tn_crm_dwy.code} + '%' }
{#endif}
// ç»ˆç«¯æ‰€å±è¥é”€åŒºåŸŸ
{#if !String.isBlank(IN.tn_crm_dwy.marketing_region)}
  and tcd.marketing_region = {IN.tn_crm_dwy.marketing_region}
{#endif}
// codeè·¯å¾„
{#if !String.isBlank(IN.tn_crm_dwy.marketing_region__codepath)}
  and tcd.marketing_region__codepath = {IN.tn_crm_dwy.marketing_region__codepath}
{#endif}
// æ¸ é“ç±»å‹
{#if !String.isBlank(IN.tn_crm_dwy.channel_type)}
  and tcd.channel_type = {IN.tn_crm_dwy.channel_type}
{#endif}
// å­—å…¸å€¼
{#if !String.isBlank(IN.tn_crm_dwy.channel_type__dicvalue)}
  and tcd.channel_type__dicvalue LIKE { '%' + {IN.tn_crm_dwy.channel_type__dicvalue} + '%' }
{#endif}
// ç»ˆç«¯çº§åˆ«
{#if !String.isBlank(IN.tn_crm_dwy.level)}
  and tcd.level = {IN.tn_crm_dwy.level}
{#endif}
// å­—å…¸å€¼
{#if !String.isBlank(IN.tn_crm_dwy.level__dicvalue)}
  and tcd.level__dicvalue LIKE { '%' + {IN.tn_crm_dwy.level__dicvalue} + '%' }
{#endif}
// è¡Œæ”¿åŒºåŸŸ
{#if !String.isBlank(IN.tn_crm_dwy.administrative_region)}
  and tcd.administrative_region = {IN.tn_crm_dwy.administrative_region}
{#endif}
// codeè·¯å¾„ç¼–ç 
{#if !String.isBlank(IN.tn_crm_dwy.administrative_region__codepath)}
  and tcd.administrative_region__codepath LIKE { '%' + {IN.tn_crm_dwy.administrative_region__codepath} + '%' }
{#endif}
// ç»ˆç«¯è´Ÿè´£äºº
{#if !String.isBlank(IN.tn_crm_dwy.manager)}
  and tcd.manager = {IN.tn_crm_dwy.manager}
{#endif}
// æˆå‘˜å§“å
{#if !String.isBlank(IN.tn_crm_dwy.manager__orgname)}
  and tcd.manager__orgname LIKE { '%' + {IN.tn_crm_dwy.manager__orgname} + '%' }
{#endif}
// å¤´é—¨ç…§ç‰‡
{#if !String.isBlank(IN.tn_crm_dwy.head_photo)}
  and tcd.head_photo = {IN.tn_crm_dwy.head_photo}
{#endif}
// åˆ›å»ºæ—¶é—´
{#if !String.isBlank(min) && !String.isBlank(max)}
  and IN.tn_crm_dwy.create_time BETWEEN { min } AND { max }
{#endif}
// ç»ˆç«¯åç§°
{#if !String.isBlank(IN.tn_crm_dwy.name)}
  and tcd.name LIKE { '%' + {IN.tn_crm_dwy.name} + '%' }
{#endif}
// ç»ˆç«¯ç±»å‹
{#if !String.isBlank(IN.tn_crm_dwy.type)}
  and tcd.type = {IN.tn_crm_dwy.type}
{#endif}
// å®¡æ‰¹çŠ¶æ€
{#if !String.isBlank(IN.tn_crm_dwy.approval_status)}
  and tcd.approval_status = {IN.tn_crm_dwy.approval_status}
{#endif}
// æŒ‰æ—¥æŸ¥è¯¢
{#if !String.isBlank(min) && !String.isBlank(max)}
  and IN.tn_crm_dwy.query_by_day BETWEEN { min } AND { max }
{#endif}
// æŒ‰å‘¨æŸ¥è¯¢
{#if !String.isBlank(min) && !String.isBlank(max)}
  and IN.tn_crm_dwy.query_by_week BETWEEN { min } AND { max }
{#endif}
// æŒ‰æœˆæŸ¥è¯¢
{#if !String.isBlank(min) && !String.isBlank(max)}
  and IN.tn_crm_dwy.query_by_month BETWEEN { min } AND { max }
{#endif}
// æŒ‰æ—¶é—´èŒƒå›´æŸ¥è¯¢å¼€å§‹
{#if !String.isBlank(IN.tn_crm_dwy.query_by_range)}
  and tcd.query_by_range = {IN.tn_crm_dwy.query_by_range}
{#endif}
 NORULE;
```

:::

#### 2. æ–°å¢/ç¼–è¾‘

æ–°å¢é¢†åŸŸåé€‰æ‹©æ“ä½œç±»å‹ä¸º`æ•°æ®æäº¤`é€‰æ‹©è¾“å…¥å®ä½“åé‡æ–°æ‰“å¼€é¢†åŸŸï¼Œå³å¯ç”Ÿæˆä»£ç ã€‚
![Alt text](image-2.png)

::: details ç‚¹å‡»æŸ¥çœ‹ç”Ÿæˆçš„ä»£ç 

```js
var errMsg = "";
var validateFail = false;

(function main() {
    validation()

    var isInsert = isInsertFunc()

    if (isInsert) {
        insert()
    } else {
        update()
    }


})()


/**
 * åˆ¤æ–­æ˜¯å¦ä¸ºæ’å…¥æ“ä½œ
 * @returns {boolean}
 */
function isInsertFunc() {
    var isInsert = false
    if (String.isBlank(IN.tn_crm_dwy.id)) {
        isInsert = true
    }
    return isInsert
}
/**
* æ’å…¥å‡½æ•°
*/
function insert() {
    var id = FLY.genId();
    IN.tn_crm_dwy.id = id;

    DB.insert(IN.tn_crm_dwy);
}

/**
* æ›´æ–°éªŒå‡½æ•°
*/
function update() {
    var temp = select * from tn_crm_dwy where id = { IN.tn_crm_dwy.id } NORULE;
    if (temp.length == 0){
        throw new ERROR("å¾…æ›´æ–°æ•°æ®ä¸å­˜åœ¨")
    }
    var tcd = IN.tn_crm_dwy
    var tn_crm_dwy = temp[0]
    // ç»ˆç«¯ID
    tn_crm_dwy.id = tcd.id
    // ç»ˆç«¯ç¼–ç 
    tn_crm_dwy.code = tcd.code
    // ç»ˆç«¯æ‰€å±è¥é”€åŒºåŸŸ
    tn_crm_dwy.marketing_region = tcd.marketing_region
    // æ¸ é“ç±»å‹
    tn_crm_dwy.channel_type = tcd.channel_type
    // ç»ˆç«¯çº§åˆ«
    tn_crm_dwy.level = tcd.level
    // è”ç³»äººå§“å
    tn_crm_dwy.contact_name = tcd.contact_name
    // è”ç³»äººç”µè¯
    tn_crm_dwy.telephone_number = tcd.telephone_number
    // è¯¦ç»†åœ°å€
    tn_crm_dwy.detailed_addresses = tcd.detailed_addresses
    // è¡Œæ”¿åŒºåŸŸ
    tn_crm_dwy.administrative_region = tcd.administrative_region
    // ç»ˆç«¯è´Ÿè´£äºº
    tn_crm_dwy.manager = tcd.manager
    // å¤´é—¨ç…§ç‰‡
    tn_crm_dwy.head_photo = tcd.head_photo
    // ç»ˆç«¯åç§°
    tn_crm_dwy.name = tcd.name
    // ç»ˆç«¯ç±»å‹
    tn_crm_dwy.type = tcd.type
    DB.update(tn_crm_dwy);
}

/**
* ç»Ÿä¸€æ ¡éªŒå‡½æ•°
*/
function validation() {
    var tcd = IN.tn_crm_dwy
    // æ ¡éªŒç»ˆç«¯ç¼–ç 
    validateCode(tcd.code)
    // æ ¡éªŒç»ˆç«¯æ‰€å±è¥é”€åŒºåŸŸ
    validateMarketingRegion(tcd.marketing_region)
    // æ ¡éªŒæ¸ é“ç±»å‹
    validateChannelType(tcd.channel_type)
    // æ ¡éªŒç»ˆç«¯çº§åˆ«
    validateLevel(tcd.level)
    // æ ¡éªŒè”ç³»äººå§“å
    validateContactName(tcd.contact_name)
    // æ ¡éªŒè¡Œæ”¿åŒºåŸŸ
    validateAdministrativeRegion(tcd.administrative_region)
    // æ ¡éªŒç»ˆç«¯è´Ÿè´£äºº
    validateManager(tcd.manager)
    // æ ¡éªŒç»ˆç«¯åç§°
    validateName(tcd.name)
    // æ ¡éªŒç»ˆç«¯ç±»å‹
    validateType(tcd.type)
    if (validateFail) {
        throw new ERROR(errMsg);
    }
}

/**
* æ ¡éªŒç»ˆç«¯ç¼–ç å‡½æ•°
*/
function validateCode(code) {
    var validationFailed = false
    var validateErrMsg = "æ ¡éªŒç»ˆç«¯ç¼–ç å¤±è´¥"
    /* Write your ValidateLogicCode */

    if (validationFailed) {
        appendErrmsg(validateErrMsg);
    }
}

/**
* æ ¡éªŒç»ˆç«¯æ‰€å±è¥é”€åŒºåŸŸå‡½æ•°
*/
function validateMarketingRegion(marketing_region) {
    var validationFailed = false
    var validateErrMsg = "æ ¡éªŒç»ˆç«¯æ‰€å±è¥é”€åŒºåŸŸå¤±è´¥"
    /* Write your ValidateLogicCode */

    if (validationFailed) {
        appendErrmsg(validateErrMsg);
    }
}

/**
* æ ¡éªŒæ¸ é“ç±»å‹å‡½æ•°
*/
function validateChannelType(channel_type) {
    var validationFailed = false
    var validateErrMsg = "æ ¡éªŒæ¸ é“ç±»å‹å¤±è´¥"
    /* Write your ValidateLogicCode */

    if (validationFailed) {
        appendErrmsg(validateErrMsg);
    }
}

/**
* æ ¡éªŒç»ˆç«¯çº§åˆ«å‡½æ•°
*/
function validateLevel(level) {
    var validationFailed = false
    var validateErrMsg = "æ ¡éªŒç»ˆç«¯çº§åˆ«å¤±è´¥"
    /* Write your ValidateLogicCode */

    if (validationFailed) {
        appendErrmsg(validateErrMsg);
    }
}

/**
* æ ¡éªŒè”ç³»äººå§“åå‡½æ•°
*/
function validateContactName(contact_name) {
    var validationFailed = false
    var validateErrMsg = "æ ¡éªŒè”ç³»äººå§“åå¤±è´¥"
    /* Write your ValidateLogicCode */

    if (validationFailed) {
        appendErrmsg(validateErrMsg);
    }
}

/**
* æ ¡éªŒè”ç³»äººç”µè¯å‡½æ•°
*/
function validateTelephoneNumber(telephone_number) {
    var validationFailed = false
    var validateErrMsg = è”ç³»ç”µè¯æ ¼å¼æœ‰è¯¯  var phoneReg = /^1[3456789]d{9}$/;
  if (!phoneReg.test(phoneNumber)) { //è”ç³»ç”µè¯æ­£åˆ™æ ¡éªŒ
    validationFailed = true
  }
    if (validationFailed) {
        appendErrmsg(validateErrMsg);
    }
}

/**
* æ ¡éªŒè¡Œæ”¿åŒºåŸŸå‡½æ•°
*/
function validateAdministrativeRegion(administrative_region) {
    var validationFailed = false
    var validateErrMsg = "æ ¡éªŒè¡Œæ”¿åŒºåŸŸå¤±è´¥"
    /* Write your ValidateLogicCode */

    if (validationFailed) {
        appendErrmsg(validateErrMsg);
    }
}

/**
* æ ¡éªŒç»ˆç«¯è´Ÿè´£äººå‡½æ•°
*/
function validateManager(manager) {
    var validationFailed = false
    var validateErrMsg = "æ ¡éªŒç»ˆç«¯è´Ÿè´£äººå¤±è´¥"
    /* Write your ValidateLogicCode */

    if (validationFailed) {
        appendErrmsg(validateErrMsg);
    }
}

/**
* æ ¡éªŒç»ˆç«¯åç§°å‡½æ•°
*/
function validateName(name) {
    var validationFailed = false
    var validateErrMsg = "æ ¡éªŒç»ˆç«¯åç§°å¤±è´¥"
    /* Write your ValidateLogicCode */

    if (validationFailed) {
        appendErrmsg(validateErrMsg);
    }
}

/**
* æ ¡éªŒç»ˆç«¯ç±»å‹å‡½æ•°
*/
function validateType(type) {
    var validationFailed = false
    var validateErrMsg = "æ ¡éªŒç»ˆç«¯ç±»å‹å¤±è´¥"
    /* Write your ValidateLogicCode */

    if (validationFailed) {
        appendErrmsg(validateErrMsg);
    }
}

/**
* å°†é”™è¯¯ä¿¡æ¯æ·»åŠ åˆ°å…¨å±€é”™è¯¯æ¶ˆæ¯ä¸­ã€‚
* @param {string} message - è¦æ·»åŠ çš„é”™è¯¯æ¶ˆæ¯ã€‚
*/
function appendErrmsg(message) {
    errMsg += message
    validateFail = true
}
/**
* éªŒè¯å­—å…¸æ˜¯å¦å­˜åœ¨
* @param {number} dictionaryid - å­—å…¸ ID
* @param {string} dictName - å­—å…¸åç§°
* @returns {void}
*/
function validateDictidExist(dictionaryid, dictName) {
    var temp = select count(*) from pl_dictionary where dictionaryid = { dictionaryid } NORULE;
    if (temp[0].count == 0) {
        appendErrmsg("å­—å…¸" + dictName + "ä¸å­˜åœ¨ï¼›")
    }
}
```

:::

### 2. å¿«é€Ÿç”Ÿæˆ Excel å¯¼å…¥å¯¼å‡ºä»£ç 

#### 1. Flycode å¯¼å‡ºåŠŸèƒ½

æ–°å¢é¢†åŸŸåé€‰æ‹©æ“ä½œç±»å‹ä¸º`å¯¼å‡º`é€‰æ‹©è¾“å…¥å®ä½“è¾“å‡ºåé‡æ–°æ‰“å¼€é¢†åŸŸï¼Œå³å¯ç”Ÿæˆä»£ç ã€‚
::: details ç‚¹å‡»æŸ¥çœ‹ç”Ÿæˆçš„ä»£ç 

```js

var _xlscolBind = [
    {
        "field": "id",
        "column": "id"
    },
    {
        "field": "promotion_main_id",
        "column": "ä¿ƒé”€æ´»åŠ¨ID"
    },
    {
        "field": "promotion_main_id__activity_name",
        "column": "ä¿ƒé”€æ´»åŠ¨åç§°"
    },
    {
        "field": "promotion_main_id__activity_code",
        "column": "ä¿ƒé”€æ´»åŠ¨ç¼–ç "
    },
    {
        "field": "group_code",
        "column": "ç»„å·"
    },
    {
        "field": "salearea_id",
        "column": "è¥é”€ç»„ç»‡"
    },
    {
        "field": "salearea_id__orgname",
        "column": "è¥é”€ç»„ç»‡åç§°"
    },
    {
        "field": "customer_id",
        "column": "å®¢æˆ·"
    },
    {
        "field": "customer_id__customername",
        "column": "å®¢æˆ·åç§°"
    },
    {
        "field": "channel_id",
        "column": "å”®è¾¾æ–¹"
    },
    {
        "field": "channel_id__channelname",
        "column": "å”®è¾¾æ–¹åç§°"
    },
    {
        "field": "store_id",
        "column": "é€è¾¾æ–¹"
    },
    {
        "field": "store_id__storename",
        "column": "é€è¾¾æ–¹åç§°"
    },
    {
        "field": "no_store_fullvalue",
        "column": "å‰”é™¤é€è¾¾æ–¹"
    },
    {
        "field": "store_quantity",
        "column": "é€è¾¾æ–¹æ•°é‡"
    },
    {
        "field": "activity_execution_cycle_start",
        "column": "æ´»åŠ¨æ‰§è¡Œå‘¨æœŸï¼ˆå˜ä»·å‘¨æœŸï¼‰å¼€å§‹"
    },
    {
        "field": "activity_execution_cycle_end",
        "column": "æ´»åŠ¨æ‰§è¡Œå‘¨æœŸï¼ˆå˜ä»·å‘¨æœŸï¼‰ç»“æŸ"
    },
    {
        "field": "terminal_execution_cycle_start",
        "column": "ç»ˆç«¯æ‰§è¡Œå‘¨æœŸï¼ˆå¸‚åœºæ£€æ ¸ï¼‰å¼€å§‹"
    },
    {
        "field": "terminal_execution_cycle_end",
        "column": "ç»ˆç«¯æ‰§è¡Œå‘¨æœŸï¼ˆå¸‚åœºæ£€æ ¸ï¼‰ç»“æŸ"
    },
    {
        "field": "business_activity_type_description",
        "column": "ä¸šåŠ¡æ´»åŠ¨ç±»å‹-Cç«¯æ´»åŠ¨è¯´æ˜"
    },
    {
        "field": "payment_method",
        "column": "å…‘ä»˜æ–¹å¼"
    },
    {
        "field": "product_range",
        "column": "äº§å“èŒƒå›´"
    },
    {
        "field": "activity_product_id",
        "column": "æ´»åŠ¨äº§å“id"
    },
    {
        "field": "activity_product_id__productname",
        "column": "äº§å“åç§°"
    },
    {
        "field": "activity_product_code",
        "column": "æ´»åŠ¨äº§å“ç‰©æ–™ç¼–ç "
    },
    {
        "field": "execution_method",
        "column": "æ‰§è¡Œæ–¹å¼"
    },
    {
        "field": "min_quantity_for_gift",
        "column": "èµ é€æ¡ä»¶â‰¥Xä»¶èµ·é€ï¼ˆæœ€å°å€¼ï¼‰"
    },
    {
        "field": "max_quantity_for_gift",
        "column": "èµ é€æ¡ä»¶â‰¥Xä»¶èµ·é€ï¼ˆæœ€å¤§å€¼ï¼‰"
    },
    {
        "field": "original_supply_price",
        "column": "åŸä¾›ä»·"
    },
    {
        "field": "guided_supply_price",
        "column": "æŒ‡å¼•ä¾›ä»·"
    },
    {
        "field": "activity_supply_price_in_cny",
        "column": "æ´»åŠ¨ä¾›ä»·ï¼ˆå…ƒï¼‰"
    },
    {
        "field": "original_selling_price",
        "column": "åŸå”®ä»·"
    },
    {
        "field": "guided_selling_price",
        "column": "æŒ‡å¼•å”®ä»·"
    },
    {
        "field": "activity_selling_price_in_cny",
        "column": "æ´»åŠ¨å”®ä»·ï¼ˆå…ƒï¼‰"
    },
    {
        "field": "sales_unit",
        "column": "é”€å”®å•ä½"
    },
    {
        "field": "exclusive_with_contract_rebate",
        "column": "æ˜¯å¦ä¸åˆåŒè¿”åˆ©äº’æ–¥"
    },
    {
        "field": "start_date",
        "column": "æ´»åŠ¨å¼€å§‹æ—¶é—´"
    },
    {
        "field": "end_date",
        "column": "æ´»åŠ¨ç»“æŸæ—¶é—´"
    },
    {
        "field": "company_discount_rate",
        "column": "å…¬å¸æŠ˜æ‰£ç‡"
    },
    {
        "field": "original_front_margin_of_store",
        "column": "å–åœºåŸå‰å°æ¯›åˆ©"
    },
    {
        "field": "promotional_front_margin_of_store",
        "column": "å–åœºæ´»åŠ¨å‰å°æ¯›åˆ©"
    },
    {
        "field": "current_pre_discount_revenue_in_cny",
        "column": "æœ¬æœŸæŠ˜å‰æ”¶å…¥ï¼ˆå…ƒï¼‰"
    },
    {
        "field": "discounted_revenue_target",
        "column": "æœ¬æœŸæ”¶å…¥ç›®æ ‡æŠ˜åï¼ˆå…ƒï¼‰"
    },
    {
        "field": "discounted_same_period_revenue_achievement",
        "column": "åŒæœŸæ”¶å…¥è¾¾æˆæŠ˜åï¼ˆå…ƒï¼‰"
    },
    {
        "field": "revenue_yoy_growth",
        "column": "æ”¶å…¥åŒæ¯”å¢é•¿"
    },
    {
        "field": "current_sales_target",
        "column": "æœ¬æœŸé”€é‡ç›®æ ‡"
    },
    {
        "field": "same_period_sales_achievement",
        "column": "åŒæœŸé”€é‡è¾¾æˆ"
    },
    {
        "field": "sales_yoy_growth",
        "column": "é”€é‡åŒæ¯”å¢é•¿"
    },
    {
        "field": "discount_expense_amount",
        "column": "æœ¬æœŸæŠ˜æ‰£è´¹ç”¨é‡‘é¢ï¼ˆå…ƒï¼‰"
    },
    {
        "field": "company_expense_ratio",
        "column": "å…¬å¸è´¹ç”¨ç‡"
    },
    {
        "field": "gross_margin_ratio",
        "column": "æ¯›åˆ©ç‡"
    },
    {
        "field": "createtime",
        "column": "åˆ›å»ºæ—¶é—´"
    },
    {
        "field": "createop",
        "column": "åˆ›å»ºäºº"
    },
    {
        "field": "updatetime",
        "column": "æ›´æ–°æ—¶é—´"
    },
    {
        "field": "updateop",
        "column": "æ›´æ–°äºº"
    },
    {
        "field": "serial_number",
        "column": "åºå·"
    }

]





var list =
SELECT
  xpsp.id,  //id
  xpsp.promotion_main_id,  //ä¿ƒé”€æ´»åŠ¨ID
  xmp_pro.activity_name as promotion_main_id__activity_name,  //ä¿ƒé”€æ´»åŠ¨åç§°
  xmp_pro.activity_code as promotion_main_id__activity_code,  //ä¿ƒé”€æ´»åŠ¨ç¼–ç 
  xpsp.salearea_id,  //è¥é”€ç»„ç»‡
  ps_sal.orgname as salearea_id__orgname,  //è¥é”€ç»„ç»‡åç§°
  xpsp.customer_id,  //å®¢æˆ·
  xc_cus.customername as customer_id__customername,  //å®¢æˆ·åç§°
  xpsp.channel_id,  //å”®è¾¾æ–¹
  xc_cha.channelname as channel_id__channelname,  //å”®è¾¾æ–¹åç§°
  xpsp.store_id,  //é€è¾¾æ–¹
  xs_sto.storename as store_id__storename,  //é€è¾¾æ–¹åç§°
  xpsp.no_store_ids,  //å‰”é™¤é€è¾¾æ–¹
  xpsp.store_quantity,  //é€è¾¾æ–¹æ•°é‡
  xpsp.activity_execution_cycle_start,  //æ´»åŠ¨æ‰§è¡Œå‘¨æœŸï¼ˆå˜ä»·å‘¨æœŸï¼‰å¼€å§‹
  xpsp.activity_execution_cycle_end,  //æ´»åŠ¨æ‰§è¡Œå‘¨æœŸï¼ˆå˜ä»·å‘¨æœŸï¼‰ç»“æŸ
  xpsp.terminal_execution_cycle_start,  //ç»ˆç«¯æ‰§è¡Œå‘¨æœŸï¼ˆå¸‚åœºæ£€æ ¸ï¼‰å¼€å§‹
  xpsp.terminal_execution_cycle_end,  //ç»ˆç«¯æ‰§è¡Œå‘¨æœŸï¼ˆå¸‚åœºæ£€æ ¸ï¼‰ç»“æŸ
  xpsp.business_activity_type_description,  //ä¸šåŠ¡æ´»åŠ¨ç±»å‹-Cç«¯æ´»åŠ¨è¯´æ˜
  xpsp.payment_method,  //å…‘ä»˜æ–¹å¼
  xpsp.product_range,  //äº§å“èŒƒå›´
  xpsp.activity_product_id,  //æ´»åŠ¨äº§å“id
  xfm_act.productname as activity_product_id__productname,  //äº§å“åç§°
  xpsp.activity_product_code,  //æ´»åŠ¨äº§å“ç‰©æ–™ç¼–ç 
  xpsp.execution_method,  //æ‰§è¡Œæ–¹å¼
  xpsp.min_quantity_for_gift,  //èµ é€æ¡ä»¶â‰¥Xä»¶èµ·é€ï¼ˆæœ€å°å€¼ï¼‰
  xpsp.max_quantity_for_gift,  //èµ é€æ¡ä»¶â‰¥Xä»¶èµ·é€ï¼ˆæœ€å¤§å€¼ï¼‰
  xpsp.original_supply_price,  //åŸä¾›ä»·
  xpsp.guided_supply_price,  //æŒ‡å¼•ä¾›ä»·
  xpsp.activity_supply_price_in_cny,  //æ´»åŠ¨ä¾›ä»·ï¼ˆå…ƒï¼‰
  xpsp.original_selling_price,  //åŸå”®ä»·
  xpsp.guided_selling_price,  //æŒ‡å¼•å”®ä»·
  xpsp.activity_selling_price_in_cny,  //æ´»åŠ¨å”®ä»·ï¼ˆå…ƒï¼‰
  xpsp.sales_unit,  //é”€å”®å•ä½
  xpsp.exclusive_with_contract_rebate,  //æ˜¯å¦ä¸åˆåŒè¿”åˆ©äº’æ–¥
  xpsp.start_date,  //æ´»åŠ¨å¼€å§‹æ—¶é—´
  xpsp.end_date,  //æ´»åŠ¨ç»“æŸæ—¶é—´
  xpsp.company_discount_rate,  //å…¬å¸æŠ˜æ‰£ç‡
  xpsp.original_front_margin_of_store,  //å–åœºåŸå‰å°æ¯›åˆ©
  xpsp.promotional_front_margin_of_store,  //å–åœºæ´»åŠ¨å‰å°æ¯›åˆ©
  xpsp.current_pre_discount_revenue_in_cny,  //æœ¬æœŸæŠ˜å‰æ”¶å…¥ï¼ˆå…ƒï¼‰
  xpsp.discounted_revenue_target,  //æœ¬æœŸæ”¶å…¥ç›®æ ‡æŠ˜åï¼ˆå…ƒï¼‰
  xpsp.discounted_same_period_revenue_achievement,  //åŒæœŸæ”¶å…¥è¾¾æˆæŠ˜åï¼ˆå…ƒï¼‰
  xpsp.revenue_yoy_growth,  //æ”¶å…¥åŒæ¯”å¢é•¿
  xpsp.current_sales_target,  //æœ¬æœŸé”€é‡ç›®æ ‡
  xpsp.same_period_sales_achievement,  //åŒæœŸé”€é‡è¾¾æˆ
  xpsp.sales_yoy_growth,  //é”€é‡åŒæ¯”å¢é•¿
  xpsp.discount_expense_amount,  //æœ¬æœŸæŠ˜æ‰£è´¹ç”¨é‡‘é¢ï¼ˆå…ƒï¼‰
  xpsp.company_expense_ratio,  //å…¬å¸è´¹ç”¨ç‡
  xpsp.gross_margin_ratio,  //æ¯›åˆ©ç‡
  xpsp.createtime,  //åˆ›å»ºæ—¶é—´
  xpsp.createop,  //åˆ›å»ºäºº
  xpsp.updatetime,  //æ›´æ–°æ—¶é—´
  xpsp.updateop,  //æ›´æ–°äºº
  xpsp.serial_number,  //åºå·
  xpsp.group_code,  //ç»„å·
  xpsp.no_store_fullvalue,  //å‰”é™¤é€è¾¾æ–¹å¤šé€‰ä¿¡æ¯
  xpsp.isdetail_data  //æ˜¯å¦ä¸ºæµ‹ç®—æ•°æ®
FROM
  xxw_promotion_special_price as xpsp
LEFT JOIN xxw_main_promotion as xmp_pro ON xmp_pro.id = xpsp.promotion_main_id
LEFT JOIN pl_orgstruct as ps_sal ON ps_sal.orgstructid = xpsp.salearea_id
LEFT JOIN xxw_customer as xc_cus ON xc_cus.id = xpsp.customer_id
LEFT JOIN xxw_channelcustomers as xc_cha ON xc_cha.id = xpsp.channel_id
LEFT JOIN xxw_store as xs_sto ON xs_sto.id = xpsp.store_id
LEFT JOIN xxw_finished_material as xfm_act ON xfm_act.id = xpsp.activity_product_id
WHERE 1=1
// ä¿ƒé”€æ´»åŠ¨ID
{#if !String.isBlank(IN.xxw_promotion_special_price.promotion_main_id)}
  and xpsp.promotion_main_id = {IN.xxw_promotion_special_price.promotion_main_id}
{#endif}
// è¥é”€ç»„ç»‡
{#if !String.isBlank(IN.xxw_promotion_special_price.salearea_id)}
  and xpsp.salearea_id = {IN.xxw_promotion_special_price.salearea_id}
{#endif}
// å®¢æˆ·
{#if !String.isBlank(IN.xxw_promotion_special_price.customer_id)}
  and xpsp.customer_id = {IN.xxw_promotion_special_price.customer_id}
{#endif}
// å®¢æˆ·åç§°
{#if !String.isBlank(IN.xxw_promotion_special_price.customer_id__customername)}
  and xpsp.customer_id__customername LIKE { '%' + {IN.xxw_promotion_special_price.customer_id__customername} + '%' }
{#endif}
// å”®è¾¾æ–¹
{#if !String.isBlank(IN.xxw_promotion_special_price.channel_id)}
  and xpsp.channel_id = {IN.xxw_promotion_special_price.channel_id}
{#endif}
// å”®è¾¾æ–¹åç§°
{#if !String.isBlank(IN.xxw_promotion_special_price.channel_id__channelname)}
  and xpsp.channel_id__channelname LIKE { '%' + {IN.xxw_promotion_special_price.channel_id__channelname} + '%' }
{#endif}
// é€è¾¾æ–¹
{#if !String.isBlank(IN.xxw_promotion_special_price.store_id)}
  and xpsp.store_id = {IN.xxw_promotion_special_price.store_id}
{#endif}
// é€è¾¾æ–¹åç§°
{#if !String.isBlank(IN.xxw_promotion_special_price.store_id__storename)}
  and xpsp.store_id__storename LIKE { '%' + {IN.xxw_promotion_special_price.store_id__storename} + '%' }
{#endif}
// // æ´»åŠ¨æ‰§è¡Œå‘¨æœŸï¼ˆå˜ä»·å‘¨æœŸï¼‰å¼€å§‹
// {#if !String.isBlank(min) && !String.isBlank(max)}
//   and IN.xxw_promotion_special_price.activity_execution_cycle_start BETWEEN { min } AND { max }
// {#endif}
// // æ´»åŠ¨æ‰§è¡Œå‘¨æœŸï¼ˆå˜ä»·å‘¨æœŸï¼‰ç»“æŸ
// {#if !String.isBlank(min) && !String.isBlank(max)}
//   and IN.xxw_promotion_special_price.activity_execution_cycle_end BETWEEN { min } AND { max }
// {#endif}
// äº§å“èŒƒå›´
{#if !String.isBlank(IN.xxw_promotion_special_price.product_range)}
  and xpsp.product_range = {IN.xxw_promotion_special_price.product_range}
{#endif}
// æ´»åŠ¨äº§å“id
{#if !String.isBlank(IN.xxw_promotion_special_price.activity_product_id)}
  and xpsp.activity_product_id = {IN.xxw_promotion_special_price.activity_product_id}
{#endif}
// æ˜¯å¦ä¸åˆåŒè¿”åˆ©äº’æ–¥
{#if !String.isBlank(IN.xxw_promotion_special_price.exclusive_with_contract_rebate)}
  and xpsp.exclusive_with_contract_rebate = {IN.xxw_promotion_special_price.exclusive_with_contract_rebate}
{#endif}
// å‰”é™¤é€è¾¾æ–¹å¤šé€‰ä¿¡æ¯
{#if !String.isBlank(IN.xxw_promotion_special_price.isdetail_data)}
  and xpsp.isdetail_data = {IN.xxw_promotion_special_price.isdetail_data}
{#endif}
 NORULE PAGING;

list.forEach(function (item) {
    if (item.no_store_fullvalue) {
        item.no_store_fullvalue = JSON.parse(item.no_store_fullvalue)
        .map(function (store) {
            return store.text
        }).join("ï¼Œ")
    }

})


OUT.xlsdata = list

```

:::

### 2. Flycode å‰ç«¯å¯¼å…¥åŠŸèƒ½

æ–°å¢é¢†åŸŸåé€‰æ‹©æ“ä½œç±»å‹ä¸º`å¯¼å‡º`ï¼Œåç§°ä¸­éœ€è¦æœ‰`å‰ç«¯å¯¼å…¥`è¿™ 4 ä¸ªå­—ï¼Œé€‰æ‹©è¾“å…¥å®ä½“ï¼ˆ`è¿™é‡Œçš„è¾“å‡ºå®ä½“ç­‰ä»·äºè¦å¯¼å‡ºçš„å­—æ®µ`ï¼‰è¾“å‡ºåé‡æ–°æ‰“å¼€é¢†åŸŸï¼Œä¸Šä¼ å‡†å¤‡å¥½çš„å¯¼å‡ºæ¨¡ç‰ˆï¼Œé…ç½®éœ€è¦æ ¡éªŒä»¥åŠåæŸ¥çš„å­—æ®µå³å¯ã€‚
å¦‚æœæ¨¡ç‰ˆä¸­çš„ç¬¬äºŒè¡Œå¤‡æ³¨æœ‰å¿…å¡«äºŒå­—ä¼šè‡ªåŠ¨å¿…å¡«ã€‚

![Alt text](image.png)
é’ˆå¯¹é•¿æ•´å‹æœªå…³è”çš„å­—æ®µå¯æ‰‹åŠ¨å…³è”
![Alt text](image-3.png)

::: details ç‚¹å‡»æŸ¥çœ‹ç”Ÿæˆçš„ä»£ç 

```js
load('amap');//åŠ è½½é«˜å¾·åœ°å›¾API
loadex("MapUtils");
load("importutils");

var errMsg = "";

var validateFail = false;

// var excelDataList = [{
//     "serial_number": "1",
//     "salearea_id": "68037365",
//     "customercode": "123",
//     "channelcode": "0000004870",
//     "storecode": "0000004870",
//     "no_storecode": "0000004140",
//     "payment_method": "è¡¥è´§",
//     "product_range": "äº§å“å¤§ç±»",
//     "productcode": "000000000050000001",
//     "gift_poduct_code": "000000000050000005",
//     "activity_period": "2023-10-01è‡³2023-10-30",
//     "complimentary_rule": "å•å“æ­èµ ",
//     "complimentary_type": "æ´»åŠ¨æœŸé—´ç´¯è®¡",
//     "achieve_target_terminate_complimentary": "æ˜¯",
//     "quantity_for_gift": "500-1000",
//     "product_quantity": "100",
//     "product_unit": "EA",
//     "gift_quantity": "10",
//     "gift_unit": "EA",
//     "mutually_exclusive_with_contract_rebate": "æ˜¯",
//     "revenue_target": "10000",
//     "current_sales_target": "1000",
//     "activity_execution_cycle": "2023-12-1åˆ°2023-12-20",
//     "terminal_execution_cycle": "2023-12-1åˆ°2023-12-20",
//     "business_activity_type_description": "ä¸šåŠ¡æ´»åŠ¨ç±»å‹-Cç«¯æ´»åŠ¨è¯´æ˜"
// }]
var excelDataList = []
var outDataList = [];
// for (var i = 0; i < IN.xxw_promotion_giveaways.length; i++) {
//     var element = IN.xxw_promotion_giveaways[i];
//     outDataList.push(element)
// }

excelImpSettingAndExecuteFunc()

for (var index = 0; index < excelDataList.length; index++) {
    // è¡Œæ•°æ®æ˜¯å¦æ ¡éªŒåˆ‡ åæŸ¥æˆåŠŸ
    var rowDataFail = false
    var rowData = excelDataList[index];
    // validation(rowData,index)
    reverseQuery(rowData, index)
    if (!rowDataFail) {
        outDataList.push(rowData)
    } else {

    }
}
// for (var i = 0; i < IN.xxw_promotion_giveaways.length; i++) {
//     var element = IN.xxw_promotion_giveaways[i];
//     outDataList.push(element)
// }

// FLY.info("å…±" + excelDataList.length + "è¡Œ" +"æˆåŠŸå¯¼å…¥" + outDataList.length + "è¡Œ")

OUT.xxw_promotion_giveaways = outDataList
OUT.errMsg = errMsg
// OUT.test = IN.xxw_promotion_giveaways


function excelRowDataHandle(exceldata, customdata) {
    //è¯»å–exceldata
    excelDataList.push(exceldata)
}

function excelImpSettingAndExecuteFunc() {
    //æ ‡é¢˜åˆ—æ˜ å°„å®šä¹‰
    var titleMappings = [
        {
            "column": "åºå·",
            "field": "serial_number",
            "type": "string"
        },
        {
            "column": "è¥é”€ç»„ç»‡ç¼–ç ",
            "field": "salearea_id",
            "type": "string"
        },
        {
            "column": "å®¢æˆ·ç¼–ç ",
            "field": "customercode",
            "type": "string"
        },
        {
            "column": "å”®è¾¾æ–¹ç¼–ç ",
            "field": "channelcode",
            "type": "string"
        },
        {
            "column": "é€è¾¾æ–¹ç¼–ç ",
            "field": "storecode",
            "type": "string"
        },
        {
            "column": "å‰”é™¤é€è¾¾æ–¹ç¼–ç ",
            "field": "no_storecode",
            "type": "string"
        },
        {
            "column": "å…‘ä»˜æ–¹å¼",
            "field": "payment_method",
            "type": "string"
        },
        {
            "column": "äº§å“èŒƒå›´",
            "field": "product_range",
            "type": "string"
        },
        {
            "column": "æ´»åŠ¨äº§å“ç¼–ç ",
            "field": "productcode",
            "type": "string"
        },
        {
            "column": "èµ å“ç¼–ç ",
            "field": "gift_productcode",
            "type": "string"
        },
        {
            "column": "æ´»åŠ¨æœŸé—´",
            "field": "activity_period",
            "type": "string"
        },
        {
            "column": "æ­èµ è§„åˆ™",
            "field": "complimentary_rule",
            "type": "string"
        },
        {
            "column": "æ­èµ æ–¹å¼",
            "field": "complimentary_type",
            "type": "string"
        },
        {
            "column": "æ˜¯å¦æŒ‰è¾¾æˆç›®æ ‡ç»ˆæ­¢æ­èµ ",
            "field": "achieve_target_terminate_complimentary",
            "type": "string"
        },
        {
            "column": "èµ é€æ¡ä»¶åŒºé—´",
            "field": "quantity_for_gift",
            "type": "string"
        },
        {
            "column": "ä¸»å“æ•°é‡(ä»¶)",
            "field": "product_quantity",
            "type": "string"
        },
        {
            "column": "èµ å“æ•°é‡",
            "field": "gift_quantity",
            "type": "string"
        },
        {
            "column": "äº§å“å•ä½",
            "field": "product_unit",
            "type": "string"
        },
        {
            "column": "èµ å“å•ä½",
            "field": "gift_unit",
            "type": "string"
        },
        {
            "column": "æ˜¯å¦ä¸åˆåŒè¿”åˆ©äº’æ–¥",
            "field": "mutually_exclusive_with_contract_rebate",
            "type": "string"
        },
        {
            "column": "æœ¬æœŸæ”¶å…¥ç›®æ ‡æŠ˜åï¼ˆå…ƒï¼‰",
            "field": "revenue_target",
            "type": "string"
        },
        {
            "column": "æœ¬æœŸé”€é‡ç›®æ ‡",
            "field": "current_sales_target",
            "type": "string"
        },
        {
            "column": "æ´»åŠ¨æ‰§è¡Œå‘¨æœŸï¼ˆå˜ä»·å‘¨æœŸï¼‰",
            "field": "activity_execution_cycle",
            "type": "string"
        },
        {
            "column": "ç»ˆç«¯æ‰§è¡Œå‘¨æœŸï¼ˆå¸‚åœºæ£€æ ¸ï¼‰",
            "field": "terminal_execution_cycle",
            "type": "string"
        },
        {
            "column": "ä¸šåŠ¡æ´»åŠ¨ç±»å‹-Cç«¯æ´»åŠ¨è¯´æ˜",
            "field": "business_activity_type_description",
            "type": "string"
        }
    ]
    //è®¾ç½®æ ‡é¢˜æ˜ å°„
    EXCELIMP.setTitleMapping(titleMappings);
    //è®¾ç½®ä¸ºå‰ç«¯å¯¼å…¥æ¨¡å¼
    EXCELIMP.setFrontImp(true);
    //æ‰¹æ¬¡å·è·å–
    var dynamicid = EXCELIMP.dynamicid;
    EXCELIMP.setExcelRowDataHandle(excelRowDataHandle)
    //execute
    EXCELIMP.execute()
}



/**
 * Excelè¡Œæ•°æ®
 * @typedef {Object} inputRowData
 * @property {string} rowData.serial_number - åºå·
 * @property {string} rowData.salearea_id - è¥é”€ç»„ç»‡ç¼–ç 
 * @property {string} rowData.customercode - å®¢æˆ·ç¼–ç 
 * @property {string} rowData.channelcode - å”®è¾¾æ–¹ç¼–ç 
 * @property {string} rowData.storecode - é€è¾¾æ–¹ç¼–ç 
 * @property {string} rowData.no_storecode - å‰”é™¤é€è¾¾æ–¹ç¼–ç 
 * @property {string} rowData.payment_method - å…‘ä»˜æ–¹å¼
 * @property {string} rowData.product_range - äº§å“èŒƒå›´
 * @property {string} rowData.productcode - æ´»åŠ¨äº§å“ç¼–ç 
 * @property {string} rowData.gift_productcode - èµ å“ç¼–ç 
 * @property {string} rowData.activity_period - æ´»åŠ¨æœŸé—´
 * @property {string} rowData.complimentary_rule - æ­èµ è§„åˆ™
 * @property {string} rowData.complimentary_type - æ­èµ æ–¹å¼
 * @property {string} rowData.achieve_target_terminate_complimentary - æ˜¯å¦æŒ‰è¾¾æˆç›®æ ‡ç»ˆæ­¢æ­èµ 
 * @property {string} rowData.quantity_for_gift - èµ é€æ¡ä»¶åŒºé—´
 * @property {string} rowData.product_quantity - èµ å“æ•°é‡
 * @property {string} rowData.product_unit -
 * @property {string} rowData.gift_quantity -
 * @property {string} rowData.gift_unit -
 * @property {string} rowData.mutually_exclusive_with_contract_rebate - æ˜¯å¦ä¸åˆåŒè¿”åˆ©äº’æ–¥
 * @property {string} rowData.revenue_target - æœ¬æœŸæ”¶å…¥ç›®æ ‡æŠ˜åï¼ˆå…ƒï¼‰
 * @property {string} rowData.current_sales_target - æœ¬æœŸé”€é‡ç›®æ ‡
 * @property {string} rowData.activity_execution_cycle - æ´»åŠ¨æ‰§è¡Œå‘¨æœŸï¼ˆå˜ä»·å‘¨æœŸï¼‰
 * @property {string} rowData.terminal_execution_cycle - ç»ˆç«¯æ‰§è¡Œå‘¨æœŸï¼ˆå¸‚åœºæ£€æ ¸ï¼‰
 * @property {string} rowData.business_activity_type_description - ä¸šåŠ¡æ´»åŠ¨ç±»å‹-Cç«¯æ´»åŠ¨è¯´æ˜
*/
/**
 * xxw_promotion_giveawayså¯¹è±¡
 * @typedef {Object} outRowData
 * @property {string} rowData.serial_number - åºå·
 * @property {string} rowData.salearea_id - è¥é”€ç»„ç»‡
 * @property {string} rowData.customer_id - TPMå®¢æˆ·id
 * @property {string} rowData.channel_id - å”®è¾¾æ–¹ID
 * @property {string} rowData.store_id - é€è¾¾æ–¹id
 * @property {string} rowData.no_store_id - å‰”é™¤é€è¾¾æ–¹id
 * @property {string} rowData.payment_method - å…‘ä»˜æ–¹å¼
 * @property {string} rowData.product_range - äº§å“èŒƒå›´
 * @property {string} rowData.activity_product_id - æ´»åŠ¨äº§å“id
 * @property {string} rowData.gift_product_id - èµ å“id
 * @property {string} rowData.activity_period - æ´»åŠ¨æœŸé—´
 * @property {string} rowData.complimentary_rule - æ­èµ è§„åˆ™
 * @property {string} rowData.complimentary_type - æ­èµ æ–¹å¼
 * @property {string} rowData.achieve_target_terminate_complimentary - æ˜¯å¦æŒ‰è¾¾æˆç›®æ ‡ç»ˆæ­¢æ­èµ 
 * @property {string} rowData.min_quantity_for_gift - èµ é€æ¡ä»¶â‰¥Xä»¶èµ·é€ï¼ˆæœ€å°å€¼ï¼‰
 * @property {string} rowData.product_quantity - æœ¬å“æ•°é‡
 * @property {string} rowData.product_unit - äº§å“å•ä½
 * @property {string} rowData.gift_quantity - èµ å“æ•°é‡
 * @property {string} rowData.gift_unit - èµ å“å•ä½
 * @property {string} rowData.mutually_exclusive_with_contract_rebate - æ˜¯å¦ä¸åˆåŒè¿”åˆ©äº’æ–¥
 * @property {string} rowData.revenue_target - æœ¬æœŸæ”¶å…¥ç›®æ ‡æŠ˜åï¼ˆå…ƒï¼‰
 * @property {string} rowData.current_sales_target - æœ¬æœŸé”€é‡ç›®æ ‡
 * @property {string} rowData.activity_execution_cycle_start - æ´»åŠ¨æ‰§è¡Œå‘¨æœŸï¼ˆå˜ä»·å‘¨æœŸï¼‰å¼€å§‹
 * @property {string} rowData.terminal_execution_cycle_start - ç»ˆç«¯æ‰§è¡Œå‘¨æœŸï¼ˆå¸‚åœºæ£€æ ¸ï¼‰å¼€å§‹
 * @property {string} rowData.activity_execution_cycle_end - æ´»åŠ¨æ‰§è¡Œå‘¨æœŸï¼ˆå˜ä»·å‘¨æœŸï¼‰ç»“æŸ
 * @property {string} rowData.terminal_execution_cycle_end - ç»ˆç«¯æ‰§è¡Œå‘¨æœŸï¼ˆå¸‚åœºæ£€æ ¸ï¼‰ç»“æŸ
 * @property {string} rowData.business_activity_type_description - ä¸šåŠ¡æ´»åŠ¨ç±»å‹-Cç«¯æ´»åŠ¨è¯´æ˜
*/


/**
 * ç»Ÿä¸€æ ¡éªŒå‡½æ•°
 * @param {inputRowData} rowData - Excelè¡Œæ•°æ®
*/
function validation(rowData, index) {
    //æ ¡éªŒ è¥é”€ç»„ç»‡
    validationSaleareaId(rowData.salearea_id, index)

    //æ ¡éªŒ TPMå®¢æˆ·id
    validationCustomercode(rowData.customercode, index)

    //æ ¡éªŒ å…‘ä»˜æ–¹å¼
    validationPaymentMethod(rowData.payment_method, index)

    //æ ¡éªŒ äº§å“èŒƒå›´
    validationProductRange(rowData.product_range, index)

    //æ ¡éªŒ æ´»åŠ¨äº§å“id
    validationProductcode(rowData.productcode, index)

    //æ ¡éªŒ èµ å“id
    validationGiftProductcode(rowData.gift_productcode, index)

    //æ ¡éªŒ æ´»åŠ¨æœŸé—´
    validationActivityPeriod(rowData.activity_period, index)

    //æ ¡éªŒ æ­èµ è§„åˆ™
    validationComplimentaryRule(rowData.complimentary_rule, index)

    //æ ¡éªŒ æ˜¯å¦æŒ‰è¾¾æˆç›®æ ‡ç»ˆæ­¢æ­èµ 
    validationAchieveTargetTerminateComplimentary(rowData.achieve_target_terminate_complimentary, index)

    //æ ¡éªŒ èµ é€æ¡ä»¶â‰¥Xä»¶èµ·é€ï¼ˆæœ€å°å€¼ï¼‰
    validationQuantityForGift(rowData.quantity_for_gift, index)

    //æ ¡éªŒ æœ¬å“æ•°é‡
    validationProductQuantity(rowData.product_quantity, index)

    //æ ¡éªŒ æ˜¯å¦ä¸åˆåŒè¿”åˆ©äº’æ–¥
    validationMutuallyExclusiveWithContractRebate(rowData.mutually_exclusive_with_contract_rebate, index)

    //æ ¡éªŒ æœ¬æœŸæ”¶å…¥ç›®æ ‡æŠ˜åï¼ˆå…ƒï¼‰
    validationRevenueTarget(rowData.revenue_target, index)

    //æ ¡éªŒ æœ¬æœŸé”€é‡ç›®æ ‡
    validationCurrentSalesTarget(rowData.current_sales_target, index)
    // if (validateFail) {
    //     throw new ERROR(errMsg);
    // }
}


/**
 * ç»Ÿä¸€åæŸ¥å‡½æ•°
* @param {inputRowData} rowData - Excelè¡Œæ•°æ®
*/
function reverseQuery(rowData, index) {
    //åæŸ¥å­—å…¸å¯¹è±¡ äº§å“èŒƒå›´
    rowData.product_range =
        getXxwProductRangeDictIdByDicvalue(rowData.product_range, index)

    //åæŸ¥å­—å…¸å¯¹è±¡ æ­èµ è§„åˆ™
    rowData.complimentary_rule =
        getXxwDynamicCategoryPromotionBundleRuleDictIdByDicvalue(rowData.complimentary_rule, index)

    //åæŸ¥å­—å…¸å¯¹è±¡ äº§å“å•ä½
    rowData.product_unit =
        getXxwProductUnitDictIdByDicvalue(rowData.product_unit, index)

    //åæŸ¥å­—å…¸å¯¹è±¡ èµ å“å•ä½
    rowData.gift_unit =
        getXxwProductUnitDictIdByDicvalue(rowData.gift_unit, index)

    //åæŸ¥å¯¹è±¡ è¥é”€ç»„ç»‡
    rowData.salearea_id =
        getPlSaleareaIdByOrgname(rowData.salearea_id, index)

    //åæŸ¥å¯¹è±¡ TPMå®¢æˆ·id
    rowData.customer_id =
        getXxwCustomerIdByCustomercode(rowData.customercode, index)
    delete rowData.customercode

    //åæŸ¥å¯¹è±¡ å”®è¾¾æ–¹ID
    rowData.channel_id =
        getXxwChannelcustomersIdByChannelcode(rowData.channelcode, index)
    delete rowData.channelcode

    //åæŸ¥å¯¹è±¡ é€è¾¾æ–¹id
    rowData.store_id =
        getXxwStoreIdByStorecode(rowData.storecode, index)
    delete rowData.storecode

    //åæŸ¥å¯¹è±¡ å‰”é™¤é€è¾¾æ–¹id
    rowData.no_store_id =
        getXxwStoreIdByStorecode(rowData.no_storecode, index)
    delete rowData.no_storecode

    //åæŸ¥å¯¹è±¡ æ´»åŠ¨äº§å“id
    rowData.activity_product_id =
        getXxwFinishedMaterialIdByProductcode(rowData.productcode, index)
    delete rowData.productcode


    //åæŸ¥å¯¹è±¡ èµ å“id
    rowData.gift_product_id =
        getXxwFinishedMaterialIdByProductcode(rowData.gift_poduct_code, index)
    delete rowData.gift_poduct_code

    //æ˜¯ å¦ å¤„ç†
    rowData.achieve_target_terminate_complimentary = convertYesNo(rowData.achieve_target_terminate_complimentary)

    rowData.mutually_exclusive_with_contract_rebate = convertYesNo(rowData.mutually_exclusive_with_contract_rebate)

    //æ­èµ æ–¹å¼
    rowData.complimentary_type = convertComplimentary_type(rowData.complimentary_type)

    //æ—¥æœŸåŒºé—´
    var activity_execution_cycle = convertPeriod(rowData.activity_execution_cycle)
    delete rowData.activity_execution_cycle
    rowData.activity_execution_cycle_start = activity_execution_cycle
    // rowData.activity_execution_cycle_end = achieve_target_terminate_complimentary.endDate
    //-------------
    var terminal_execution_cycle = convertPeriod(rowData.terminal_execution_cycle)
    delete rowData.terminal_execution_cycle
    rowData.terminal_execution_cycle_start = terminal_execution_cycle
    // rowData.terminal_execution_cycle_end = achieve_target_terminate_complimentary.endDate
    //------------
    var activity_period = convertPeriod(rowData.activity_period)
    delete rowData.activity_period

    rowData.start_date = activity_period
    // åŒºé—´å¤„ç†
    var pair = convertRange(rowData.quantity_for_gift)
    rowData.min_quantity_for_gift = pair.min
    rowData.max_quantity_for_gift = pair.max
    // å…‘ä»˜æ–¹å¼å¯¹é€‰å¤„ç†
    rowData.payment_method = convertPayment_method(rowData.payment_method)
    // rowData.end_date = achieve_target_terminate_complimentary.endDate
    // if (validateFail) {
    //     throw new ERROR(errMsg);
    // }
}

/**
 * å…‘ä»˜æ–¹å¼å¯¹é€‰å¤„ç†
 * @param {string} payment_method - 1
 */
function convertPayment_method(payment_method) {
    var separator = ";"

    if (payment_method.indexOf(";") != null) {
        separator = ";"
    }
    if (payment_method.indexOf("ï¼›") != null) {
        separator = "ï¼›"
    }
    var split = payment_method.split(separator)
    var payment_methods = []
    for (var i = 0; i < split.length; i++) {
        var element = split[i];
        var dictid = getxxw_pay_typeDictIdByDicvalue(element)
        if (!String.isBlank(dictid)) {
            payment_methods.push(dictid)
        }
    }
    return JSON.stringify(payment_methods)

}

/**
 * åŒºé—´å¤„ç†å‡½æ•°
 * @param {string} - range
 */
function convertRange(range) {
    if (String.isBlank(range)) {
        return {
            max: null,
            min: null
        }
    }
    if (range.indexOf("-") != -1) {
        var pair = range.split("-")
        return {
            max: pair[1],
            min: pair[0]
        }
    }
    if (Number(range) > 0) {
        return {
            max: null,
            min: range
        }
    }
}

/**
 * æ­èµ è§„åˆ™
 * 0éšå•è®¡ç®—
 * 1æ´»åŠ¨æœŸé—´ç´¯è®¡
 */
function convertComplimentary_type(complimentary_type) {
    if (complimentary_type == "éšå•è®¡ç®—") {
        return 0
    } else if (complimentary_type == "æ´»åŠ¨æœŸé—´ç´¯è®¡") {
        return 1
    }
    return ''
}


/**
 * æ—¥æœŸåŒºé—´è½¬æ¢
 */
function convertPeriod(period) {
    if (String.isBlank(period))
        return ''
    FLY.log(period)
    var pair
    if (period.indexOf("è‡³") != -1) {
        pair = period.trim().split("è‡³")
    } else if (period.indexOf("åˆ°") != -1) {
        pair = period.trim().split("åˆ°")
    } else return ''

    FLY.log(JSON.stringify(pair))
    if (pair.length == 2) {
        var startDate = new Date(pair[0]).getTime()
        var endDate = new Date(pair[1]).getTime()
        FLY.log(endDate)
        if (startDate < endDate) {
            return JSON.stringify(
                {
                    start: startDate,
                    end: endDate
                }
            )
        }
    }
    return ''
}

/**
 * æ˜¯å¦è½¬æ¢ä¸º0å¦1æ˜¯
 */
function convertYesNo(value) {
    if (value == 'æ˜¯') {
        return 1
    }
    return 0
}
/**
 * æ ¡éªŒ SaleareaId-è¥é”€ç»„ç»‡
*/
function validationSaleareaId(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(è¥é”€ç»„ç»‡)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ Customercode-TPMå®¢æˆ·id
*/
function validationCustomercode(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(TPMå®¢æˆ·id)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ PaymentMethod-å…‘ä»˜æ–¹å¼
*/
function validationPaymentMethod(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(å…‘ä»˜æ–¹å¼)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ ProductRange-äº§å“èŒƒå›´
*/
function validationProductRange(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(äº§å“èŒƒå›´)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ Productcode-æ´»åŠ¨äº§å“id
*/
function validationProductcode(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(æ´»åŠ¨äº§å“id)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ GiftProductcode-èµ å“id
*/
function validationGiftProductcode(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(èµ å“id)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ ActivityPeriod-æ´»åŠ¨æœŸé—´
*/
function validationActivityPeriod(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(æ´»åŠ¨æœŸé—´)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ ComplimentaryRule-æ­èµ è§„åˆ™
*/
function validationComplimentaryRule(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(æ­èµ è§„åˆ™)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ AchieveTargetTerminateComplimentary-æ˜¯å¦æŒ‰è¾¾æˆç›®æ ‡ç»ˆæ­¢æ­èµ 
*/
function validationAchieveTargetTerminateComplimentary(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(æ˜¯å¦æŒ‰è¾¾æˆç›®æ ‡ç»ˆæ­¢æ­èµ )ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ QuantityForGift-èµ é€æ¡ä»¶â‰¥Xä»¶èµ·é€ï¼ˆæœ€å°å€¼ï¼‰
*/
function validationQuantityForGift(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(èµ é€æ¡ä»¶â‰¥Xä»¶èµ·é€ï¼ˆæœ€å°å€¼ï¼‰)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ ProductQuantity-æœ¬å“æ•°é‡
*/
function validationProductQuantity(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(æœ¬å“æ•°é‡)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ MutuallyExclusiveWithContractRebate-æ˜¯å¦ä¸åˆåŒè¿”åˆ©äº’æ–¥
*/
function validationMutuallyExclusiveWithContractRebate(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(æ˜¯å¦ä¸åˆåŒè¿”åˆ©äº’æ–¥)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ RevenueTarget-æœ¬æœŸæ”¶å…¥ç›®æ ‡æŠ˜åï¼ˆå…ƒï¼‰
*/
function validationRevenueTarget(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(æœ¬æœŸæ”¶å…¥ç›®æ ‡æŠ˜åï¼ˆå…ƒï¼‰)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}



/**
 * æ ¡éªŒ CurrentSalesTarget-æœ¬æœŸé”€é‡ç›®æ ‡
*/
function validationCurrentSalesTarget(data, index) {
    if (String.isBlank(data)) {
        appendErrmsg("(æœ¬æœŸé”€é‡ç›®æ ‡)ï¼šä¸èƒ½ä¸ºç©º")
    }

    if (validateFail) {
        throw new ERROR(errMsg);
    }
}

/**
 * æ ¹æ®å­—å…¸å€¼è·å– xxw_product_range çš„ dictionaryid
 * @param {string} dicvalue - å­—å…¸å€¼
 * @returns {number} xxw_product_range çš„ dictionaryid
*/
function getXxwProductRangeDictIdByDicvalue(dicvalue) {
    var temp = select dictionaryid from xxw_product_range where dicvalue = { dicvalue } NORULE;
    if (temp.length != 0) {
        return temp[0].dictionaryid
    } else {
        return dicvalue
        appendErrmsg("å­—å…¸å€¼(äº§å“èŒƒå›´)ï¼š" + dictivalue + "ä¸å­˜åœ¨ï¼›")
    }
}


/**
 * æ ¹æ®å­—å…¸å€¼è·å– xxw_dynamic_category_promotion_bundle_rule çš„ dictionaryid
 * @param {string} dicvalue - å­—å…¸å€¼
 * @returns {number} xxw_dynamic_category_promotion_bundle_rule çš„ dictionaryid
*/
function getXxwDynamicCategoryPromotionBundleRuleDictIdByDicvalue(dicvalue) {
    var temp = select dictionaryid from xxw_dynamic_category_promotion_bundle_rule where dicvalue = { dicvalue } NORULE;
    if (temp.length != 0) {
        return temp[0].dictionaryid
    } else {
        return dicvalue
        appendErrmsg("å­—å…¸å€¼(æ­èµ è§„åˆ™)ï¼š" + dictivalue + "ä¸å­˜åœ¨ï¼›")
    }
}


/**
 * æ ¹æ®å­—å…¸å€¼è·å– xxw_product_unit çš„ dictionaryid
 * @param {string} dicvalue - å­—å…¸å€¼
 * @returns {number} xxw_product_unit çš„ dictionaryid
*/
function getXxwProductUnitDictIdByDicvalue(dicvalue) {
    var temp = select dictionaryid from xxw_product_unit where dicvalue = { dicvalue } NORULE;
    if (temp.length != 0) {
        return temp[0].dictionaryid
    } else {
        return dicvalue
        appendErrmsg("å­—å…¸å€¼(äº§å“å•ä½)ï¼š" + dictivalue + "ä¸å­˜åœ¨ï¼›")
    }
}


/**
 * æ ¹æ®å­—å…¸å€¼è·å– xxw_pay_type çš„ dictionaryid
 * @param {string} dicvalue - å­—å…¸å€¼
 * @returns {number} xxw_pay_type çš„ dictionaryid
*/
function getxxw_pay_typeDictIdByDicvalue(dicvalue) {
    var temp = select dictionaryid from xxw_pay_type where dicvalue = { dicvalue } NORULE;
    if (temp.length != 0) {
        return temp[0].dictionaryid
    } else {
        return ''
        appendErrmsg("å­—å…¸å€¼(å…‘ä»˜æ–¹å¼)ï¼š" + dictivalue + "ä¸å­˜åœ¨ï¼›")
    }
}

/**
 * æ ¹æ®å­—å…¸å€¼è·å– xxw_product_unit çš„ dictionaryid
 * @param {string} dicvalue - å­—å…¸å€¼
 * @returns {number} xxw_product_unit çš„ dictionaryid
*/
function getXxwProductUnitDictIdByDicvalue(dicvalue) {
    var temp = select dictionaryid from xxw_product_unit where dicvalue = { dicvalue } NORULE;
    if (temp.length != 0) {
        return temp[0].dictionaryid
    } else {
        return dicvalue
        appendErrmsg("å­—å…¸å€¼(èµ å“å•ä½)ï¼š" + dictivalue + "ä¸å­˜åœ¨ï¼›")
    }
}


function getPlSaleareaIdByOrgname(orgaccountcode, pl_salearea_bo) {
    if (String.isBlank(orgaccountcode)) {
        appendErrmsg("(è¥é”€ç»„ç»‡ä»£ç )ï¼šä¸èƒ½ä¸ºç©º")
    }
    var temp = select ps.orgstructid from
     pl_salearea ps
     left join pl_org org on org.orgid = ps.orgid
      where orgaccountcode = { orgaccountcode } NORULE;
    if (temp.length == 0) {
        return ''
    } else {
        return temp[0].orgstructid
        appendErrmsg("ä¸šåŠ¡å¯¹è±¡(è¥é”€ç»„ç»‡)ï¼š" + value + "ä¸å­˜åœ¨ï¼›")
    }
}


/**
 * æ ¹æ® customercode è·å– xxw_customer çš„ id
 * @param {string} - xxw_customer çš„ customercode çš„å€¼
 * @returns {number} xxw_customer çš„ id
*/
function getXxwCustomerIdByCustomercode(customercode, xxw_customer_bo) {
    if (String.isBlank(customercode)) {
        appendErrmsg("(TPMå®¢æˆ·id)ï¼šä¸èƒ½ä¸ºç©º")
    }
    var temp = select id from xxw_customer where customercode = { customercode } NORULE;
    if (temp.length == 0) {
        return ''
    } else {
        return temp[0].id
        appendErrmsg("ä¸šåŠ¡å¯¹è±¡(TPMå®¢æˆ·id)ï¼š" + value + "ä¸å­˜åœ¨ï¼›")
    }
}


/**
 * æ ¹æ® channelcode è·å– xxw_channelcustomers çš„ id
 * @param {string} - xxw_channelcustomers çš„ channelcode çš„å€¼
 * @returns {number} xxw_channelcustomers çš„ id
*/
function getXxwChannelcustomersIdByChannelcode(channelcode, xxw_channelcustomers_bo) {
    if (String.isBlank(channelcode)) {
        appendErrmsg("(å”®è¾¾æ–¹ID)ï¼šä¸èƒ½ä¸ºç©º")
    }
    var temp = select id from xxw_channelcustomers where channelcode = { channelcode } NORULE;
    if (temp.length == 0) {
        return ''
    } else {
        return temp[0].id
        appendErrmsg("ä¸šåŠ¡å¯¹è±¡(å”®è¾¾æ–¹ID)ï¼š" + value + "ä¸å­˜åœ¨ï¼›")
    }
}


/**
 * æ ¹æ® storecode è·å– xxw_store çš„ id
 * @param {string} - xxw_store çš„ storecode çš„å€¼
 * @returns {number} xxw_store çš„ id
*/
function getXxwStoreIdByStorecode(storecode, xxw_store_bo) {
    if (String.isBlank(storecode)) {
        appendErrmsg("(é€è¾¾æ–¹id)ï¼šä¸èƒ½ä¸ºç©º")
    }
    var temp = select id from xxw_store where storecode = { storecode } NORULE;
    if (temp.length == 0) {
        return ''
    } else {
        return temp[0].id
        appendErrmsg("ä¸šåŠ¡å¯¹è±¡(é€è¾¾æ–¹id)ï¼š" + value + "ä¸å­˜åœ¨ï¼›")
    }
}


/**
 * æ ¹æ® storecode è·å– xxw_store çš„ id
 * @param {string} - xxw_store çš„ storecode çš„å€¼
 * @returns {number} xxw_store çš„ id
*/
function getXxwStoreIdByStorecode(storecode, xxw_store_bo) {
    if (String.isBlank(storecode)) {
        appendErrmsg("(å‰”é™¤é€è¾¾æ–¹id)ï¼šä¸èƒ½ä¸ºç©º")
    }
    var temp = select id from xxw_store where storecode = { storecode } NORULE;
    if (temp.length == 0) {
        return ''
    } else {
        return temp[0].id
        appendErrmsg("ä¸šåŠ¡å¯¹è±¡(å‰”é™¤é€è¾¾æ–¹id)ï¼š" + value + "ä¸å­˜åœ¨ï¼›")
    }
}


/**
 * æ ¹æ® productcode è·å– xxw_finished_material çš„ id
 * @param {string} - xxw_finished_material çš„ productcode çš„å€¼
 * @returns {number} xxw_finished_material çš„ id
*/
function getXxwFinishedMaterialIdByProductcode(productcode, xxw_finished_material_bo) {
    if (String.isBlank(productcode)) {
        appendErrmsg("(æ´»åŠ¨äº§å“id)ï¼šä¸èƒ½ä¸ºç©º")
    }
    var temp = select id from xxw_finished_material where productcode = { productcode } NORULE;
    if (temp.length == 0) {
        return ''
    } else {
        return temp[0].id
        appendErrmsg("ä¸šåŠ¡å¯¹è±¡(æ´»åŠ¨äº§å“id)ï¼š" + value + "ä¸å­˜åœ¨ï¼›")
    }
}


/**
 * æ ¹æ® productcode è·å– xxw_finished_material çš„ id
 * @param {string} - xxw_finished_material çš„ productcode çš„å€¼
 * @returns {number} xxw_finished_material çš„ id
*/
function getXxwFinishedMaterialIdByProductcode(productcode, xxw_finished_material_bo) {
    if (String.isBlank(productcode)) {
        appendErrmsg("(èµ å“id)ï¼šä¸èƒ½ä¸ºç©º")
    }
    var temp = select id from xxw_finished_material where productcode = { productcode } NORULE;
    if (temp.length == 0) {
        return ''
    } else {
        return temp[0].id
        appendErrmsg("ä¸šåŠ¡å¯¹è±¡(èµ å“id)ï¼š" + value + "ä¸å­˜åœ¨ï¼›")
    }
}


/**
* å°†é”™è¯¯ä¿¡æ¯æ·»åŠ åˆ°å…¨å±€é”™è¯¯æ¶ˆæ¯ä¸­ã€‚
* @param {string} message - è¦æ·»åŠ çš„é”™è¯¯æ¶ˆæ¯ã€‚
*/
function appendErrmsg(message) {
    errMsg += message
    validateFail = true
}

```

:::

### 3. Flycode å¯¼å‡ºåŠŸèƒ½

ä¸å‰ç«¯å¯¼å…¥ç±»ä¼¼ä¸åšè¯´æ˜ã€‚

#### ä»£ç è¡¥å…¨å¢å¼º

Flycode ä»£ç è¡¥å…¨ä»¥åŠä»£ç æç¤º

ä¸»è¦è½¬æ¢äº†æ–‡æ¡£ä¸­çš„è¯´æ˜ï¼Œä»¥åŠè½¬æ¢å®ä½“åè®®ä¸º `.d.ts` æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ `monaco` çš„ `addExtraLib` åŠŸèƒ½ï¼Œå®ç°äº†ä»£ç è¡¥å…¨åŠŸèƒ½ã€‚
ä¸»è¦æ¶µç›–çš„æ–‡æ¡£ä¸­çš„ APIï¼Œå®ä½“è¯´æ˜ï¼Œbonew,IN,OUT å‚æ•°ç­‰ã€‚

**ä»£ç æç¤º**
![Alt text](image-5.png)

**IN/OUT å‚æ•°æç¤º**
![Alt text](image-6.png)

**BO.new æç¤º**
![Alt text](image-7.png)

---

**Flycode æç¤º**
![Alt text](image-4.png)

---

**uiFlycode æç¤º**
![Alt text](image-8.png)

---

**uiFlycode æç¤º**
![Alt text](image-9.png)

---

**select å¯ä»¥æ­£ç¡®è¿”å›ä¸ºæ•°ç»„**
![Alt text](image-10.png)

---

### 4.ä»£ç ç”Ÿæˆ

::: info
ä»£ç ç”Ÿæˆåªæœ‰ä¸€ä¸ªå¿«æ·é”® WIN(Ctrl+B) Mac(Cmd+B)
:::

#### 1.BO.new ç”Ÿæˆ

ç¼–è¾‘å™¨ä¸­è¾“å…¥ new + å®ä½“åç§° WIN(Ctrl+B) Mac(Cmd+B) å³å¯ç”Ÿæˆã€‚
![Alt text](image-11.png)

#### 2.select ç”Ÿæˆ

ç¼–è¾‘å™¨ä¸­è¾“å…¥ (`select`or`sel`) + å®ä½“åç§° WIN(Ctrl+B) Mac(Cmd+B) å³å¯ç”Ÿæˆã€‚
![Alt text](image-12.png)

#### 3.å¯è¿è¡¨ select ç”Ÿæˆ

ç¼–è¾‘å™¨ä¸­è¾“å…¥ (`selectc`or`selc`) + å®ä½“åç§° WIN(Ctrl+B) Mac(Cmd+B) å³å¯ç”Ÿæˆã€‚
![Alt text](image-13.png)

```sql
SELECT
  xmp.id,  //ä¸»é”®
  xmp.relevance_type,  //å…³è”ä¿ƒé”€æŒ‡å¼•çŠ¶æ€
  xmp.guide_id,  //ä¿ƒé”€æŒ‡å¼•id
  xmp.guide_name,  //ä¿ƒé”€æŒ‡å¼•åç§°
  xmp.guide_type,  //ä¿ƒé”€æŒ‡å¼•ç±»å‹
  xmp.activity_name,  //ä¿ƒé”€æ´»åŠ¨åç§°
  xmp.channel,  //æ¸ é“
  xpc_cha.channel_id as channel__channel_id,  //æ¸ é“id
  xmp.start_date,  //å¼€å§‹æ—¥æœŸ
  xmp.end_date,  //ç»“æŸæ—¥æœŸ
  xmp.placement_scope,  //æŠ•æ”¾èŒƒå›´
  xmp.business_activity_type,  //ä¸šåŠ¡æ´»åŠ¨ç±»å‹
  xpa_bus.promotion_main_id as business_activity_type__promotion_main_id,  //ä¿ƒé”€æ´»åŠ¨ä¸»è¡¨id
  xmp.apply_amount,  //ç”³è¯·é‡‘é¢
  xmp.make_amends,  //æ˜¯å¦åè¡¥æ´»åŠ¨
  xmp.guide_exceed,  //æŒ‡å¼•è¶…æ ‡
  xmp.budget_exceed,  //é¢„ç®—è¶…æ ‡
  xmp.authorize,  //æ˜¯å¦æˆæƒè´¹ç”¨
  xmp.submitter,  //æäº¤äºº
  xmp.submitting_salearea,  //æäº¤éƒ¨é—¨
  xmp.submission_time,  //æäº¤æ—¶é—´
  xmp.attachment,  //é™„ä»¶
  xmp.active_state,  //æ´»åŠ¨çŠ¶æ€
  xmp.confirm_state,  //ç¡®å®šçŠ¶æ€
  xmp.createtime,  //åˆ›å»ºæ—¶é—´
  xmp.createop,  //åˆ›å»ºäºº
  xmp.updatetime,  //æ›´æ–°æ—¶é—´
  xmp.updateop,  //æ›´æ–°äºº
  xmp.activity_code,  //ä¿ƒé”€æ´»åŠ¨ç¼–ç 
  xmp.explain  //ç”³è¯·è¯´æ˜
FROM
  xxw_main_promotion as xmp
LEFT JOIN xxw_promotional_channel as xpc_cha ON xpc_cha.id = xmp.channel
LEFT JOIN xxw_promotion_activity as xpa_bus ON xpa_bus.id = xmp.business_activity_type
 NORULE;
```

4. for å¾ªç¯

ç¼–è¾‘å™¨ä¸­è¾“å…¥ (`for`) + xxx WIN(Ctrl+B) Mac(Cmd+B) å³å¯ç”Ÿæˆã€‚
![Alt text](image-16.png)

### 5.SQL æ ¼å¼åŒ–(win:Ctrl + F9 Mac:Cmd + F9)

before

![Alt text](image-14.png)

after

![Alt text](image-15.png)

### 6. ä¸»é¢˜è‡ªå®šä¹‰åŠä»£ç é«˜äº®

PS : æš‚æ—¶åªé€‚é…äº†æµ…è‰²ä¸»é¢˜

> æ•ˆæœå›¾

---

**before**
![Alt text](image-18.png)

**after**
![Alt text](image-17.png)

<style>
.vp-adaptive-theme{height: 700px;}
</style>
